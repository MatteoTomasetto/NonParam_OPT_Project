main='Adjusted Survival Probability Plot')
grid()
legend('bottomleft', c("min", "mean", "max"),
lty=c(1,1,1), lwd=c(2,2,2), col=c("dodgerblue2","navy","darkmagenta"))
ggcoxdiagnostics(cox, type = "martingale")
ggcoxdiagnostics(cox, type = "deviance")
ggcoxdiagnostics(cox, type = "schoenfeld")
test.ph <- cox.zph(cox)
test.ph
# Goodness-of-fit
ggcoxdiagnostics(cox_threshold, type = "martingale")
cov1_threshold <- df$V5.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
cov_values_threshold <- data.frame(cov1_threshold = c(min(cov1_threshold[which(!is.na(cov1_threshold))]),mean(cov1_threshold[which(!is.na(cov1_threshold))]),max(cov1_threshold[which(!is.na(cov1_threshold))])))
KM_cov_threshold <- survfit(cox_threshold, newdata = cov_values_threshold)
x11()
plot(KM_cov_threshold, conf.int=F,
col=c("dodgerblue2","navy","darkmagenta"), lwd=2, lty=1,
xlab='Time [days]', ylab='Survival Probability',
main='Adjusted Survival Probability Plot')
grid()
legend('bottomleft', c("min", "mean", "max"),
lty=c(1,1,1), lwd=c(2,2,2), col=c("dodgerblue2","navy","darkmagenta"))
cov1_threshold <- df$V5.PD.avg[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
cov1_threshold <- df$V5.Calc.avg[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
cov1_threshold
df$V5.Calc.avg[which(times <= threshold)]
cov1_threshold <- df$V5.P1.I[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
### Consider the pre-term births only
cov1_threshold <- df$V5.Calc.I[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
cov1_threshold
n <- dim(df)[1]
times <- df[,176]  # Delivery times; unit of measure = days
lost_to_FU <- which(is.na(df[,70]))
censoring <- rep(0,n)
censoring[lost_to_FU] <- 1
censoring <- factor(censoring, labels = (c('Event', 'Censor')))
groups <- df$Group # select categorical variable significant for delivery times (see permutational inference results)
# Apply thresholding to see only pre-term birth
threshold <- 260
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$BL.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
cov1_threshold <- df$BL.PD.avg[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
cov1_threshold <- df$V3.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
cov1_threshold <- df$V5.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
cov1_threshold
summary(cox_threshold)
cov_values_threshold <- data.frame(cov1_threshold = c(min(cov1_threshold[which(!is.na(cov1_threshold))]),mean(cov1_threshold[which(!is.na(cov1_threshold))]),max(cov1_threshold[which(!is.na(cov1_threshold))])))
KM_cov_threshold <- survfit(cox_threshold, newdata = cov_values_threshold)
x11()
plot(KM_cov_threshold, conf.int=F,
col=c("dodgerblue2","navy","darkmagenta"), lwd=2, lty=1,
xlab='Time [days]', ylab='Survival Probability',
main='Adjusted Survival Probability Plot')
grid()
legend('bottomleft', c("min", "mean", "max"),
lty=c(1,1,1), lwd=c(2,2,2), col=c("dodgerblue2","navy","darkmagenta"))
cov1_threshold <- df$V5.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
x11()
plot(KM_cov_threshold, conf.int=F,
col=c("dodgerblue2","navy","darkmagenta"), lwd=2, lty=1,
xlab='Time [days]', ylab='Survival Probability',
main='Adjusted Survival Probability Plot')
grid()
legend('bottomleft', c("min", "mean", "max"),
lty=c(1,1,1), lwd=c(2,2,2), col=c("dodgerblue2","navy","darkmagenta"))
threshold <- 280
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$V5.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
threshold <- 270
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$V5.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
threshold <- 255
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$V5.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
threshold <- 259
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$V5.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
threshold <- 250
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$V5.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
threshold <- 255
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$V5.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
cov1_threshold <- df$V5.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
x11()
ggforest(cox_threshold, data = as.data.frame(cbind(cov1_threshold,times_threshold,censoring_threshold)))
cov_values_threshold <- data.frame(cov1_threshold = c(min(cov1_threshold[which(!is.na(cov1_threshold))]),mean(cov1_threshold[which(!is.na(cov1_threshold))]),max(cov1_threshold[which(!is.na(cov1_threshold))])))
KM_cov_threshold <- survfit(cox_threshold, newdata = cov_values_threshold)
x11()
plot(KM_cov_threshold, conf.int=F,
col=c("dodgerblue2","navy","darkmagenta"), lwd=2, lty=1,
xlab='Time [days]', ylab='Survival Probability',
main='Adjusted Survival Probability Plot')
grid()
legend('bottomleft', c("min", "mean", "max"),
lty=c(1,1,1), lwd=c(2,2,2), col=c("dodgerblue2","navy","darkmagenta"))
threshold <- 240
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$V5.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
x11()
ggforest(cox_threshold, data = as.data.frame(cbind(cov1_threshold,times_threshold,censoring_threshold)))
cov_values_threshold <- data.frame(cov1_threshold = c(min(cov1_threshold[which(!is.na(cov1_threshold))]),mean(cov1_threshold[which(!is.na(cov1_threshold))]),max(cov1_threshold[which(!is.na(cov1_threshold))])))
KM_cov_threshold <- survfit(cox_threshold, newdata = cov_values_threshold)
x11()
plot(KM_cov_threshold, conf.int=F,
col=c("dodgerblue2","navy","darkmagenta"), lwd=2, lty=1,
xlab='Time [days]', ylab='Survival Probability',
main='Adjusted Survival Probability Plot')
grid()
legend('bottomleft', c("min", "mean", "max"),
lty=c(1,1,1), lwd=c(2,2,2), col=c("dodgerblue2","navy","darkmagenta"))
threshold <- 245
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$V5.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
plot(survfit(cox_threshold, data=as.data.frame(cbind(cov1_threshold,cov2_threshold,times_threshold,censoring_threshold))),
col="darkorange2", lwd=2, lty=1,
xlab='Time [days]', ylab='Survival Probability',
main='Baseline estimated survival probability')
cov_values_threshold <- data.frame(cov1_threshold = c(min(cov1_threshold[which(!is.na(cov1_threshold))]),mean(cov1_threshold[which(!is.na(cov1_threshold))]),max(cov1_threshold[which(!is.na(cov1_threshold))])))
KM_cov_threshold <- survfit(cox_threshold, newdata = cov_values_threshold)
x11()
plot(KM_cov_threshold, conf.int=F,
col=c("dodgerblue2","navy","darkmagenta"), lwd=2, lty=1,
xlab='Time [days]', ylab='Survival Probability',
main='Adjusted Survival Probability Plot')
grid()
legend('bottomleft', c("min", "mean", "max"),
lty=c(1,1,1), lwd=c(2,2,2), col=c("dodgerblue2","navy","darkmagenta"))
### Consider the pre-term births only
cov1_threshold <- df$V5.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cov2_threshold <- df$V5.Calc.I[which(times <= threshold)]
cov3_threshold <- df$V5.Pl.I[which(times <= threshold)]
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold + cov2_threshold + cov3_threshold)
summary(cox_threshold)
### Consider the pre-term births only
cov1_threshold <- df$BL.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cov2_threshold <- df$BL.Calc.I[which(times <= threshold)]
cov3_threshold <- df$BL.Pl.I[which(times <= threshold)]
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold + cov2_threshold + cov3_threshold)
summary(cox_threshold)
### Consider the pre-term births only
cov1_threshold <- df$V3.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cov2_threshold <- df$V3.Calc.I[which(times <= threshold)]
cov3_threshold <- df$V3.Pl.I[which(times <= threshold)]
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold + cov2_threshold + cov3_threshold)
summary(cox_threshold)
### Consider the pre-term births only
cov1_threshold <- df$V3.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cov2_threshold <- df$V3.Calc.I[which(times <= threshold)]
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold + cov2_threshold)
summary(cox_threshold)
cov1_threshold <- df$V5.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cov2_threshold <- df$V5.Calc.I[which(times <= threshold)]
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold + cov2_threshold)
summary(cox_threshold)
threshold <- 235
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
### Consider the pre-term births only
cov1_threshold <- df$V5.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cov2_threshold <- df$V5.Calc.I[which(times <= threshold)]
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold + cov2_threshold)
summary(cox_threshold)
### Consider the pre-term births only
cov1_threshold <- df$V5.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
threshold <- 230
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$V5.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
cov_values_threshold <- data.frame(cov1_threshold = c(min(cov1_threshold[which(!is.na(cov1_threshold))]),mean(cov1_threshold[which(!is.na(cov1_threshold))]),max(cov1_threshold[which(!is.na(cov1_threshold))])))
KM_cov_threshold <- survfit(cox_threshold, newdata = cov_values_threshold)
x11()
plot(KM_cov_threshold, conf.int=F,
col=c("dodgerblue2","navy","darkmagenta"), lwd=2, lty=1,
xlab='Time [days]', ylab='Survival Probability',
main='Adjusted Survival Probability Plot')
grid()
legend('bottomleft', c("min", "mean", "max"),
lty=c(1,1,1), lwd=c(2,2,2), col=c("dodgerblue2","navy","darkmagenta"))
# Apply thresholding to see only pre-term birth
threshold <- 258
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
### Consider the pre-term births only
cov1_threshold <- df$V5.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
### Consider the pre-term births only
cov1_threshold <- df$V5.Calc.I[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
threshold <- 230
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
### Consider the pre-term births only
cov1_threshold <- df$V3.Calc.I[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
cov1_threshold
df$V3.Calc.I
threshold <- 255
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$V3.Calc.I[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
cov_values_threshold <- data.frame(cov1_threshold = c(min(cov1_threshold[which(!is.na(cov1_threshold))]),mean(cov1_threshold[which(!is.na(cov1_threshold))]),max(cov1_threshold[which(!is.na(cov1_threshold))])))
KM_cov_threshold <- survfit(cox_threshold, newdata = cov_values_threshold)
x11()
plot(KM_cov_threshold, conf.int=F,
col=c("dodgerblue2","navy","darkmagenta"), lwd=2, lty=1,
xlab='Time [days]', ylab='Survival Probability',
main='Adjusted Survival Probability Plot')
grid()
legend('bottomleft', c("min", "mean", "max"),
lty=c(1,1,1), lwd=c(2,2,2), col=c("dodgerblue2","navy","darkmagenta"))
cov1_threshold
### Consider the pre-term births only
cov1_threshold <- df$V3.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
cov1_threshold <- df$V3.Pl.I[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
### Consider the pre-term births only
cov1_threshold <- df$V3.PD.avg[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
cov1_threshold <- df$V3.CALC.avg[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
cov1_threshold <- df$V3.CAL.avg[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
threshold <- 260
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$V3.CAL.avg[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
cov1_threshold <- df$V3.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
cov1_threshold <- df$V3.P1.I[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
cov1_threshold <- df$V3.Pl.I[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
cov1_threshold <- df$V3.Calc.I[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
threshold <- 270
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$V3.Calc.I[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
threshold <- 265
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$V3.Calc.I[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
threshold <- 259
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$V3.Calc.I[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
threshold <- 260
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$V3.Calc.I[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
cov1_threshold
threshold <- 250
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$V3.Calc.I[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
threshold <- 245
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$V3.Calc.I[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
threshold <- 240
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$V3.Calc.I[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
threshold <- 235
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$V3.Calc.I[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
cov1_threshold <- df$V3.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
threshold <- 240
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$V3.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
threshold <- 245
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$V3.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
threshold <- 250
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$V3.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
threshold <- 260
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$V3.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
cov1_threshold
### Consider the pre-term births only
cov1_threshold <- df$Bacteria5.perc[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
threshold <- 245
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$Bacteria5.perc[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
cov1_threshold
threshold <- 235
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$BL.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
threshold <- 230
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$BL.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
threshold <- 260
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
cov1_threshold <- df$BL.GE[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
threshold <- 230
times_threshold <- times[which(times <= threshold)]
censoring_threshold <- censoring[which(times <= threshold)]
groups_threshold <- groups[which(times <= threshold)]
n <- dim(df)[1]
times <- df[,176]  # Delivery times; unit of measure = days
lost_to_FU <- which(is.na(df[,70]))
censoring <- rep(0,n)
censoring[lost_to_FU] <- 1
censoring <- factor(censoring, labels = (c('Event', 'Censor')))
groups <- df$Group # select categorical variable significant for delivery times (see permutational inference results)
cov1 <- df$Bacteria.perc # select covariates significant for the delivery time
cox <- coxph(Surv(times, censoring=="Event") ~ cov1)
summary(cox)
cov1 <- df$Bacteria.perc5 # select covariates significant for the delivery time
cox <- coxph(Surv(times, censoring=="Event") ~ cov1)
summary(cox)
cov1 <- df$Bacteria5.perc # select covariates significant for the delivery time
cox <- coxph(Surv(times, censoring=="Event") ~ cov1)
summary(cox)
cov1
cov1 <- df$Bacteria.perc # select covariates significant for the delivery time
cov1
cov1 <- df$Bacteria # select covariates significant for the delivery time
cox <- coxph(Surv(times, censoring=="Event") ~ cov1)
summary(cox)
cov1 <- df$Age # select covariates significant for the delivery time
cox <- coxph(Surv(times, censoring=="Event") ~ cov1)
summary(cox)
cov1 <- df$BMI # select covariates significant for the delivery time
cox <- coxph(Surv(times, censoring=="Event") ~ cov1)
summary(cox)
cov1_threshold <- df$BMI[which(times <= threshold)]  # select covariates significant for the delivery time (see permutational inference results)
cox_threshold <- coxph(Surv(times_threshold, censoring_threshold=="Event") ~ cov1_threshold)
summary(cox_threshold)
cov_values <- data.frame(cov1 = c(min(cov1[which(!is.na(cov1))]),mean(cov1[which(!is.na(cov1))]),max(cov1[which(!is.na(cov1))])))
KM_cov <- survfit(cox, newdata = cov_values)
x11()
plot(KM_cov, conf.int=F,
col=c("dodgerblue2","navy","darkmagenta"), lwd=2, lty=1,
xlab='Time [days]', ylab='Survival Probability',
main='Adjusted Survival Probability Plot')
grid()
legend('bottomleft', c("min", "mean", "max"),
lty=c(1,1,1), lwd=c(2,2,2), col=c("dodgerblue2","navy","darkmagenta"))
control.BL.GE <- df$BL.GE[which(df$Group == 'C')]
treat.BL.GE <- df$BL.GE[which(df$Group == 'T')]
control.BL.Calc.I <- df$BL.Calc.I[which(df$Group == 'C')]
treat.BL.Calc.I <- df$BL.Calc.I[which(df$Group == 'T')]
control.V3.GE <- df$V3.GE[which(df$Group == 'C')]
treat.V3.GE <- df$V3.GE[which(df$Group == 'T')]
control.V5.GE <- df$V5.GE[which(df$Group == 'C')]
treat.V5.GE <- df$V5.GE[which(df$Group == 'T')]
control.V5.PD.avg <- df$V5.PD.avg[which(df$Group == 'C')]
treat.V5.PD.avg <- df$V5.PD.avg[which(df$Group == 'T')]
summary(control.BL.GE)
summary(treat.BL.GE)
boxplot(control.BL.GE, treat.BL.GE)
summary(control.BL.Calc.I)
summary(treat.BL.Calc.I)
boxplot(control.BL.Calc.I, treat.BL.Calc.I)
summary(control.V3.GE)
summary(treat.V3.GE)
boxplot(control.V3.GE, treat.V3.GE)
summary(control.V5.GE)
summary(treat.V5.GE)
boxplot(control.V5.GE, treat.V5.GE)
summary(control.V5.PD.avg)
summary(treat.V5.PD.avg)
boxplot(control.V5.PD.avg, treat.V5.PD.avg)
summary(control.BL.GE)
summary(treat.BL.GE)
boxplot(control.BL.GE, treat.BL.GE)
